# prometheus

![Version: 0.0.3](https://img.shields.io/badge/Version-0.0.3-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 0.0.1](https://img.shields.io/badge/AppVersion-0.0.1-informational?style=flat-square)

A Helm chart for Prometheus

## Requirements

- [helm 3](https://helm.sh/docs/intro/install/)
- These mandatory configuration values:
	 - serviceName - The name of the service - e.g. `csc`, `eco-iot`
	 - servicePort - The port of the service - e.g. `80`

## Usage

- [Here](./README.md#values) is a full list of all configuration values.
- The [values.yaml file](./values.yaml) shows the raw view of all configuration values.

## Installation

### Quick install with internal service of type ClusterIP

By default, this helm chart installs the Prometheus as NodePort.
This is to prevent exposing the service to the internet by accident!

It is recommended to put non-sensitive configuration values in a configuration file and pass sensitive/secret values via commandline.

1. Download the values from helm chart `prometheus` and update them accordingly

    ```shell
    helm show values pharmaledger-imi/prometheus > my-values.yaml
    ```

2. Install via helm to namespace `default`

    ```bash
    helm upgrade my-release-name pharmaledger-imi/prometheus --version=0.0.3 \
        --install \
        --values my-values.yaml \
    ```

## Additional helm options

Run `helm upgrade --helm` for full list of options.

1. Install to other namespace

    You can install into other namespace than `default` by setting the `--namespace` parameter, e.g.

    ```bash
    helm upgrade my-release-name pharmaledger-imi/prometheus --version=0.0.3 \
        --install \
        --namespace=my-namespace \
        --values my-values.yaml \
    ```

2. Wait until installation has finished successfully and the deployment is up and running.

    Provide the `--wait` argument and time to wait (default is 5 minutes) via `--timeout`

    ```bash
    helm upgrade my-release-name pharmaledger-imi/prometheus --version=0.0.3 \
        --install \
        --wait --timeout=600s \
        --values my-values.yaml \
    ```

## Maintainers

| Name | Email | Url |
| ---- | ------ | --- |
| mastaleru |  | <https://github.com/mastaleru> |
| paiusCatalin |  | <https://github.com/paiusCatalin> |

## Values

*Note:* Please scroll horizontally to show more columns (e.g. description)!

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| configMap.mountPath | string | `"/etc/prometheus/prometheus.yml"` |  |
| configMap.name | string | `"prometheus-configuration"` |  |
| configMap.subPath | string | `"prometheus.yml"` |  |
| configMap.volumeName | string | `"prometheus-config-volume"` |  |
| data.prometheusYml | string | `"global:\n  scrape_interval: 45s\n  evaluation_interval: 15s\n  external_labels:\n    type: \"governance-metrics\"\n\nscrape_configs:\n  - job_name: \"metrics\"\n    static_configs:\n      - targets: [ \"csc:80\" ]\n\n  - job_name: \"validator1\"\n    scrape_interval: 30s\n    metrics_path: /debug/metrics/prometheus\n    static_configs:\n      - targets: [ \"quorum-validator1:9545\" ]\n\n  - job_name: \"validator2\"\n    scrape_interval: 30s\n    metrics_path: /debug/metrics/prometheus\n    static_configs:\n      - targets: [ \"quorum-validator2:9545\" ]\n\n  - job_name: \"validator3\"\n    scrape_interval: 30s\n    metrics_path: /debug/metrics/prometheus\n    static_configs:\n      - targets: [ \"quorum-validator3:9545\" ]\n\n  - job_name: \"validator4\"\n    scrape_interval: 30s\n    metrics_path: /debug/metrics/prometheus\n    static_configs:\n      - targets: [ \"quorum-validator4:9545\" ]"` |  |
| deployment.imageName | string | `"prom/prometheus"` |  |
| deployment.imagePullPolicy | string | `"IfNotPresent"` |  |
| deployment.replicaSet | int | `1` |  |
| general.defaultNamespace | string | `"default"` |  |
| general.httpPort | int | `9090` |  |
| general.name | string | `"prometheus"` |  |
| general.serviceType | string | `"NodePort"` |  |
| storageVolume.mountPath | string | `"/prometheus/"` |  |
| storageVolume.storageClassName | string | `""` |  |
| storageVolume.storageSize | string | `"5Gi"` |  |
| storageVolume.volumeName | string | `"prometheus-storage-volume"` |  |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.11.0](https://github.com/norwoodj/helm-docs/releases/v1.11.0)
