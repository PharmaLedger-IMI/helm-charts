{{- $nodeKeyPublic := "" }}
{{- $enode := "" }}
{{- if .Values.use_case.newNetwork.enabled }}
  {{- $generatedPublicJson := ( .Values.use_case.newNetwork.plugin_data_common | fromJson ) }}
  {{- $enode = $generatedPublicJson.enode }}
  {{- $nodeKeyPublic = $generatedPublicJson.nodeKeyPublic }}
{{- else }}
  {{- $generatedPublicJson := ( .Values.use_case.joinNetwork.plugin_data_common | fromJson ) }}
  {{- $enode = $generatedPublicJson.enode }}
  {{- $nodeKeyPublic = $generatedPublicJson.nodeKeyPublic }}
{{- end }}
---
# nodekey address public and used to generate istanbul-validator-config.toml
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "quorumNode.Identifier" . }}-nodekeypub
  namespace: {{ default .Release.Namespace }}
  labels:
    name: {{ include "quorumNode.Identifier" . }}-nodekeypub
data:
  nodekey.pub: | {{ $nodeKeyPublic | nindent 4 }}

---
# enode Id
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "quorumNode.Identifier" . }}-enode
  namespace: {{ default .Release.Namespace }}
  labels:
    name: {{ include "quorumNode.Identifier" . }}-enode
data:
  enode: | {{ $enode | nindent 4 }}

---

